{% extends 'base.html.twig' %}

{% block title %}Contact - Cr√©a'Tech{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
        /* Carte Sombre */
        #map { height: 100%; min-height: 400px; width: 100%; z-index: 0; background: #1d232a; }
        
        /* Personnalisation des popups Leaflet */
        .leaflet-popup-content-wrapper, .leaflet-popup-tip {
            background-color: #191e24;
            color: #a6adbb;
            border: 1px solid #f28c18;
            font-family: 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', monospace;
        }

        /* Effet "Panneau High-Tech" */
        .tech-panel {
            background-color: rgba(29, 35, 42, 0.95);
            background-image: linear-gradient(rgba(242, 140, 24, 0.05) 1px, transparent 1px), 
                              linear-gradient(90deg, rgba(242, 140, 24, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            border: 1px solid rgba(242, 140, 24, 0.3);
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
    </style>
{% endblock %}

{% block body %}
    <div class="min-h-screen bg-base-300 relative overflow-hidden py-12">
        
        {# Fond d'ambiance #}
        <div class="absolute inset-0 pointer-events-none opacity-10" 
             style="background-image: radial-gradient(circle at center, #f28c18 0%, transparent 70%);">
        </div>

        <div class="container mx-auto px-4 relative z-10">
            
            {# --- EN-T√äTE --- #}
            <div class="text-center mb-12">
                <div class="inline-block mb-4">
                    <span class="badge badge-primary badge-outline font-mono tracking-widest gap-2 p-3">
                        <span class="w-2 h-2 rounded-full bg-primary animate-ping"></span>
                        STATUS: ONLINE
                    </span>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary via-white to-primary">
                    INITIER LA CONNEXION
                </h1>
                <p class="mt-4 text-lg font-mono text-primary/80">
                    &lt;system&gt; Pr√™t √† coder votre futur projet &lt;/system&gt;
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
                
                {# --- GAUCHE : FORMULAIRE --- #}
                <div class="tech-panel rounded-xl p-6 relative overflow-hidden group">
                    <div class="absolute top-0 left-0 w-full h-1 bg-primary/50 shadow-[0_0_15px_#f28c18] -translate-y-full group-hover:translate-y-[600px] transition-transform duration-[2000ms]"></div>
                    
                    <h2 class="text-2xl font-bold mb-6 flex items-center gap-3 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
                        Envoyer un message
                    </h2>
                    
                    {{ form_start(form) }}
                        <div class="flex flex-col gap-5">
                            <div class="form-control">
                                <label class="label font-mono text-xs uppercase opacity-70">Identifiant (Nom)</label>
                                {{ form_widget(form.nom, {'attr': {'class': 'input input-bordered bg-base-200/50 border-primary/20 focus:border-primary font-mono', 'placeholder': 'Votre nom'}}) }}
                                <div class="text-error text-xs mt-1 font-mono">{{ form_errors(form.nom) }}</div>
                            </div>

                            <div class="form-control">
                                <label class="label font-mono text-xs uppercase opacity-70">Canal de r√©ponse (Email)</label>
                                {{ form_widget(form.email, {'attr': {'class': 'input input-bordered bg-base-200/50 border-primary/20 focus:border-primary font-mono', 'placeholder': 'votre@email.com'}}) }}
                                <div class="text-error text-xs mt-1 font-mono">{{ form_errors(form.email) }}</div>
                            </div>

                            <div class="form-control">
                                <label class="label font-mono text-xs uppercase opacity-70">Objet</label>
                                {{ form_widget(form.sujet, {'attr': {'class': 'input input-bordered bg-base-200/50 border-primary/20 focus:border-primary font-mono'}}) }}
                            </div>

                            <div class="form-control">
                                <label class="label font-mono text-xs uppercase opacity-70">Donn√©es (Message)</label>
                                {{ form_widget(form.message, {'attr': {'class': 'textarea textarea-bordered h-32 bg-base-200/50 border-primary/20 focus:border-primary font-mono', 'placeholder': 'Dites-moi tout...'}}) }}
                                <div class="text-error text-xs mt-1 font-mono">{{ form_errors(form.message) }}</div>
                            </div>

                            <button type="submit" class="btn btn-primary w-full shadow-[0_0_20px_rgba(242,140,24,0.4)] hover:shadow-[0_0_30px_rgba(242,140,24,0.6)] border-none mt-2">
                                Transmettre la demande
                            </button>
                        </div>
                    {{ form_end(form) }}
                </div>

                {# --- DROITE : LOCALISATION + TEXTE EXPLICATIF --- #}
                <div class="flex flex-col gap-6">
                    
                    {# 1. La Carte Radar #}
                    <div class="tech-panel rounded-xl overflow-hidden h-[300px] relative p-1">
                        <div class="absolute top-0 left-0 w-8 h-8 border-t-2 border-l-2 border-primary z-10"></div>
                        <div class="absolute top-0 right-0 w-8 h-8 border-t-2 border-r-2 border-primary z-10"></div>
                        <div class="absolute bottom-0 left-0 w-8 h-8 border-b-2 border-l-2 border-primary z-10"></div>
                        <div class="absolute bottom-0 right-0 w-8 h-8 border-b-2 border-r-2 border-primary z-10"></div>

                        <div id="map" class="rounded opacity-90"></div>
                    </div>

                    {# 2. LE TEXTE EXPLICATIF (AJOUT√â) #}
                    <div class="tech-panel rounded-xl p-6 border-l-4 border-l-primary">
                        <h3 class="text-xl font-bold text-white mb-3 flex items-center gap-2">
                            <span class="text-primary">üìç</span> Zone d'Intervention
                        </h3>
                        <p class="text-gray-300 leading-relaxed mb-4">
                            <strong class="text-white">Je me d√©place physiquement</strong> pour vous rencontrer et √©tudier votre projet sur place.
                        </p>
                        <div class="bg-base-200/50 p-4 rounded-lg border border-white/5">
                            <p class="font-bold text-primary mb-2">Rayon d'action : 30 km autour de Vimy</p>
                            <p class="text-sm opacity-80">
                                J'interviens sans frais de d√©placement sur les secteurs de :
                            </p>
                            <ul class="list-disc list-inside mt-2 text-sm text-gray-400 marker:text-primary">
                                <li>Arras & Lens-Li√©vin</li>
                                <li>Douai & H√©nin-Beaumont</li>
                                <li>B√©thune & Bruay</li>
                                
                            </ul>
                        </div>
                    </div>

                    {# Stats techniques #}
                    <div class="tech-panel rounded-xl p-4 flex justify-between items-center font-mono text-xs opacity-70">
                        <span>LAT: 50.3739</span>
                        <span>LNG: 2.8104</span>
                        <span class="text-success">SECTEUR: 62</span>
                    </div>

                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const lat = 50.373953;
            const lng = 2.810418;
            
            var map = L.map('map', {
                zoomControl: false,
                scrollWheelZoom: false,
                dragging: false // Carte fixe pour effet "Radar"
            }).setView([lat, lng], 9);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '',
                subdomains: 'abcd',
                maxZoom: 19
            }).addTo(map);

            // QG
            L.circleMarker([lat, lng], {
                radius: 6,
                fillColor: "#f28c18",
                color: "#fff",
                weight: 2,
                opacity: 1,
                fillOpacity: 1
            }).addTo(map);

            // Zone 50km
            L.circle([lat, lng], {
                color: '#f28c18',
                fillColor: '#f28c18',
                fillOpacity: 0.15,
                radius: 30000,
                weight: 1,
                dashArray: '4, 8'
            }).addTo(map);
        });
    </script>
{% endblock %}