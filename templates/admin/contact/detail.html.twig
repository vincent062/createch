{# templates/admin/contact/detail.html.twig #}
{% extends '@EasyAdmin/page/content.html.twig' %}

{% block head_stylesheets %}
    {{ parent() }}
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
{% endblock %}

{% block head_javascript %}
    {{ parent() }}
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            corePlugins: {
                preflight: false, // Indispensable pour ne pas casser le menu EasyAdmin
            }
        }
    </script>
{% endblock %}

{% block content %}
    {# On récupère l'objet Contact via la variable 'entity.instance' fournie par EasyAdmin #}
    {% set contact = entity.instance %}

    <div data-theme="halloween" class="min-h-[80vh] p-4 md:p-8 rounded-xl bg-base-100 shadow-xl border border-base-300 font-sans">
        
        {# En-tête du message #}
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 pb-6 border-b border-base-content/10">
            <div>
                <h1 class="text-3xl font-bold text-primary mb-2">
                    <i class="fas fa-envelope-open-text mr-2"></i> Message reçu
                </h1>
                <p class="text-base-content/60">
                    Envoyé le {{ contact.createdAt|date('d/m/Y à H:i') }}
                </p>
            </div>
            
            <a href="{{ ea_url().setController('App\\Controller\\Admin\\ContactCrudController').setAction('index') }}" 
               class="btn btn-outline btn-secondary btn-sm mt-4 md:mt-0">
                <i class="fas fa-arrow-left mr-2"></i> Retour à la liste
            </a>
        </div>

        {# Carte de l'expéditeur #}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            
            {# Colonne Gauche : Info Expéditeur #}
            <div class="md:col-span-1 space-y-6">
                <div class="card bg-base-200 shadow-lg border border-base-300">
                    <div class="card-body">
                        <h2 class="card-title text-secondary text-sm uppercase tracking-widest mb-4">Expéditeur</h2>
                        
                        <div class="flex items-center gap-3 mb-4">
                            <div class="avatar placeholder">
                                <div class="bg-neutral text-neutral-content rounded-full w-12">
                                    <span class="text-xl">{{ contact.nom|first|upper }}</span>
                                </div>
                            </div>
                            <div>
                                <div class="font-bold text-lg">{{ contact.nom }}</div>
                                <div class="text-xs text-success">Client potentiel</div>
                            </div>
                        </div>

                        <div class="divider my-1"></div>

                        <div class="form-control w-full">
                            <label class="label"><span class="label-text">Email</span></label>
                            <div class="flex items-center gap-2 text-base-content/80 bg-base-100 p-2 rounded-lg border border-base-300">
                                <i class="fas fa-at text-accent"></i>
                                <a href="mailto:{{ contact.email }}" class="link link-hover text-sm truncate">{{ contact.email }}</a>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                             <a href="mailto:{{ contact.email }}?subject=RE: {{ contact.sujet }}" class="btn btn-primary w-full">
                                <i class="fas fa-reply"></i> Répondre
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            {# Colonne Droite : Le Message #}
            <div class="md:col-span-2">
                <div class="card bg-base-200 shadow-lg border border-base-300 h-full">
                    <div class="card-body">
                        <h2 class="card-title text-secondary text-sm uppercase tracking-widest mb-2">Contenu</h2>
                        
                        <h3 class="text-2xl font-bold mb-6 text-base-content">{{ contact.sujet }}</h3>
                        
                        <div class="bg-base-100 p-6 rounded-lg border border-base-300 min-h-[200px] text-lg leading-relaxed whitespace-pre-line shadow-inner">
                            {{ contact.message }}
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
{% endblock %}